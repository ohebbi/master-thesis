\chapter{Predictions}

Using the four algorithms, optimized at each of the three approaches, and applying them to the case of predicting materials as good qubit material hosts or not yields $12$ sets of results. In this chapter we present sets of representative results for each approach. Because of their length, we provide comprehensive tables of the machine learning classifications of the test sets and the training sets in Ref. \cite{Ohebbi2021}.

\section{The Ferrenti approach}

We first consider the machine learning classification of the test set based on the Ferrenti approach.

Out of the known good candidates defined for the insightful approach, we find many of them in the Ferrenti training set. Carbon in diamond-like structures is present, but we also find two-dimensional carbon in graphite-like structure labelled as good. All structures of Si is defined as good candidates, together with one entry of SiC. Of other potentially good entries, we find ZnS, ZnSe, ZnO and ZnTe present.

\input{results/tikz-plots/ferrenti-approach.tex}

The number of predicted candidates are labelled in figure \ref{fig:01-predictions}. Logistic regression finds a total of $12380$ good candidates, while decision tree is the most conservative with $11315$. Random forest has the most optimistic estimate with $14278$, while gradient boost finds $11835$ good candidates. The models seems to agree on $6804$ good candidates, however, many of the materials are predicted with the probability of similar proportions to a coin-flip. This is examplified if we were to raise the minimum bar of a prediction to $0.7$, which would make the models only agree on $3000$ good candidates. We have included a histogram displaying the distribution of probabilites on the test set in figure \ref{fig:histogram-ferrenti}. In particular, we find that almost all of random forest's predictions are based on a large uncertainty. This behaviour is explained by the nature of random forest, since random forest base the predictions on an average of predictions in the ensemble of trees. Variance in the underlying trees will bias predictions close to either $0$ or $1$ \cite{NiculescuMizil2005}. Thus, all trees needs to agree on either one or zero for a resulting probability close to either one or zero.

\begin{figure}[ht!]
    \centering
    \input{../predicting-solid-state-qubit-candidates/reports/figures/histogram/summary-01-ferrenti-approach.tex}
    \vspace*{-130mm}
    \caption{A histogram displaying the distribution of probabilites for all models based on the Ferrenti approach. If the probability is higher (lower) than $0.5$, we label the material as a good (bad) candidate.}
    \label{fig:histogram-ferrenti}
\end{figure}

For the known materials that were present in the test set, we find that all models admit almost all materials with a chemical formula matching the known candidates. The one exception is the decision tree model, which labels C60 Fullerene, cubic Si, cubic GaAs, AlP, GaP, AlaAs and ZnTe as bad candidates. This is unfortunate, since this allows materials with unfortunate structures to be labelled as a good candidate by all models. Consequently, the models does not recognize the strict band gap restriction which makes it challenging to fascilitate deep defects. This is visualized in the parallel coordinate plot in figure \ref{fig:parallel-coordinates-ferrenti}, where the probability for being labelled a good candidate for $250$ random entries with band gap less than $5$eV is displayed. Ideally, we would expect that the models would have probabilities lower than $0.5$ for all models when the band gap is lower than $0.5$eV, which would be expected behaviour based on the training set, but this is not the case. We find that many entries with band gap lower than $0.5$, marked as strong red lines in the parallel histogram, are present as both good and bad candidates for all models. Therefore, it seems the algorithms have found a trend in the data set that does not neccessarily favor deep defects.

\begin{figure}[ht!]
    \centering
    \input{../predicting-solid-state-qubit-candidates/reports/figures/parallel_coordinates/summary-01-ferrenti-approach.pgf}
    \vspace*{-130mm}
    \caption{A parallel coordinate plot of $250$ random entries in the test set with MP-calculated band gap less than $5$eV. The figure is based on the Ferrenti approach.}
    \label{fig:parallel-coordinates-ferrenti}
\end{figure}

\begin{comment}
\begin{table}[!ht]
\centering
\caption{Table of the number of predictions made with the optimal model for the insightful approach. }
\label{tab:timing-extraction}
\noindent\makebox[\textwidth]{
\begin{tabular}{M{3.0cm} M{4.0cm} M{4.0cm}}
  \hline
  \hline
   Model & Optimal number PC & Number of predictions \\
  \hline
  Logistic regression & $145$  & $454$ \\
  Decision trees      &  $3$   & $442$ \\
  Random forest       &  $10 $ & $325$ \\
  Gradient boost      &  $7$   & $699$ \\
  \hline
  \hline
\end{tabular}
}
\end{table}
\end{comment}


\section{The augmented Ferrenti approach}
Then we turn towards the perhaps more liberal augmented Ferrenti approach with the result visualized in figure \ref{fig:02-predictions}, where we find the most predicted candidates with $14993$, $14407$, $15351$ and $13788$ for logistic regression, decision tree, random forest and gradient boost, respectively. The probability distribution of the predictions are visualized in figure \ref{fig:histogram-augmented-ferrenti}. Three of the models, that is gradient boost, decision tree and logistic regression, are very confident in their labelling of good candidates and base their predictions on close to $100\%$ probability. Random forest, on the other hand, experience the same variance as in the Ferrenti approach. We observe a peak between $0.75$ and $0.8$, indicating a larger number of positive predictions. Due to the easier restrictions compared to the Ferrenti approach, we find the large amount of $9227$ entries that the four models agree on.

\input{results/tikz-plots/augmented-ferrenti-approach.tex}

In the training set, we find a single entry of SiC, Si, GaN, ZnS, GaP, AlAs and AlP, carbon in both diamond- and graphite-like structure andAlN in three different structures. Interestingly, a larger variety of the known candidates are present compared to the Ferrenti approach, but due to the larger band gap restriction we find fewer of each known chemical formula present in the training set.

\begin{figure}[ht!]
    \centering
    \input{../predicting-solid-state-qubit-candidates/reports/figures/histogram/summary-02-augmented-ferrenti-approach.tex}
    \vspace*{-130mm}
    \caption{A histogram displaying the distribution of probabilites for all models based on the augmented Ferrenti approach. If the probability is higher (lower) than $0.5$, we label the material as a good (bad) candidate.}
    \label{fig:histogram-augmented-ferrenti}
\end{figure}

The summary of the test set reveals that all of the unlabelled known good candidates are, in fact, predicted as good candidates. Logistic regression predicts a single exception, as it labels almost all structures present of ZnTe as bad candidates. Unfortunately, due to the large number of good candidates, it also reveals unqualified predictions. All models confidently predict NaCl as a good candidate, which is in fact bad due to the phonon-interactions within the lattice that would substantially increase decoherence. Additionally, we find that this approach also predicts materials with band gap lower than $0.5$eV as good candidates.


\section{The insightful approach}

Finally, we turn to the insightful approach, with the results displayed in figure \ref{fig:03-predictions}. The four models predicts radically fewer good candidates compared to the two latter approaches, where only $493$, $442$, $321$ and $629$ materials are predicted good by logistic regression, decision tree, random forest and gradient boost, respectively. The large majority of the bad candidates are predicted with large probability by all models. However, we find also in this approach the presence of good candidates with band gap lower than $0.5$eV. All the models agree on only $105$ good candidates, which reduces to $85$ by imposing the bandgap restriction.

\input{results/tikz-plots/insightful-approach.tex}

Initially, we begin with looking at all materials that are predicted by all models with more than $80\%$ probability, which are ZnGeP$_2$, He, BC$_2$N, N$_2$ and RuC. None of these entries have a band gap lower than $0.5$eV, but we see that the list includes noble gases. The noble gases are described in the data with no ionic character, no electronegativity, low covalent radius, large band gaps and simple structures. Furthermore, they are missing entries on most of the descriptors and we do not have a feature describing any physics of noble gases. We therefore believe the noble gases can be regarded as outliers, and are therefore not offered additional consideration.

ZnGeP$_2$ (mp-$4524$) is a tetrahedrally coordinated material, chalcopyrite-like structure, with reported MP calculated indirect band gap of $1.2$ \cite{Zhang2015} and experimentally reported as $1.99$eV\cite{Xing1989}. It crystallize in a non-polar space group, possess no magnetic moment, have strong covalent bondings and has been reported as an excellent mid-IR transparent crystal material which is suitable for nonlinear optical applications \cite{Zhang2015}. Importantly, it is possible to integrate sources of photon quantum states based on nonlinear optics \cite{Caspani2017}. An eligible candidate indeed, but it remains unknown if the candidate can provide isolation and shelter to experimentally fascilitate a deep defect with quantum effects.

We also find two compositions with the same chemical formula, the orthorombic coordinated (mp-$629458$) and the chalcopyrite-like structured BC$_2$N (mp-$1008523$). The first structure is in a polar space group while the latter is not. The band gaps are in MP calculated as $1.85$eV and $1.65$eV, respectively. BC$_2$N is known as heterodiamond and is a super hard hybrid of diamond and BN. Both structures have, as expected, strong covalent character and have been studied for application as nanostructures \cite{Gao2017}, hydrogen storage \cite{Cai2017} and superhard materials \cite{Li2017, Jiang2020} in ab-initio calculations. The structures are still in early development, but might show promising host qualities for use in quantum technology.

Lastly, we find RuC (mp-$1009792$) in the rock-salt cubic structure as a predicted candidate. It is a relatively new and unstudied composition, which is found unstable in terms of energy above hull / atom in MP, and have an MP calculate indirect band gap of $0.72$eV \cite{RuC2020}.

Random forest, due to the average of trees, experience a smaller probability than the other models. If we leave the model out, we gain a list of $65$ predicted good candidates for the three other models with probability of at least $80\%$. A few noteworthy compounds that are not yet mentioned include Ge, GeC, BP and InP. Ge in cubic structure (mp-1198022) share many similar properties with Si and C as well as sharing periodic column number. In fact, the first transistors was made in germanium to its appealing eletrical properties, but silicon took over as the material of choice for microelectronics due to the outstanding quality of silicone dioxide, which allowed the fabrication and integration of increasingly smaller transistors \cite{Scappucci2020, Pillarisetty2011}. Ge has the highest hole mobility of semiconductors at room temperature, and is therefore considered a key material when in the process of extending the chip performance in classical computers beyond the limits imposed by miniaturization \cite{Scappucci2020}.


-Write about GeC, BP, LnP.
\\

We acknowledge that many compositions deemed as good candidates consists of either rare or dangerous elements. By utilizing an enormously large database as Materials Project, we have to account for their ultimate goal - to model all possible materials and their properties. Thus, unphysical descriptors needs to be manually applied during the postpartum analysis.

\begin{figure}[ht!]
  \begin{subfigure}{0.5\textwidth}
    \centering
    \includegraphics[trim={10cm 0cm 12cm 4cm},clip, scale=0.5]{../predicting-solid-state-qubit-candidates/reports/figures/pca-3d-plots/training-data-3d.png}
    \caption{Hvor stort er dette bildet?}
    \label{}
  \end{subfigure}
  \begin{subfigure}{0.5\textwidth}
    \centering
    \includegraphics[trim={10cm 0cm 12cm 4cm},clip, scale=0.5]{../predicting-solid-state-qubit-candidates/reports/figures/pca-3d-plots/training-data-isosurface-3d.png}
    \caption{Hvor stort er dette bildet?}
    \label{}
  \end{subfigure}
  \begin{subfigure}{0.5\textwidth}
    \centering
    \includegraphics[trim={10cm 0cm 12cm 4cm},clip, scale=0.5]{../predicting-solid-state-qubit-candidates/reports/figures/pca-3d-plots/test-set-iso-3d.png}
    \caption{Hvor stort er dette bildet?}
    \label{}
  \end{subfigure}
\end{figure}


\section{Comparison of the approaches}

Out of the three approaches, we find that the augmented approach is the least restricted approach and admits the most entries. The Ferrenti approach also admits a large amount of entries, and is considered to not be very different from the Augmented Ferrenti approach. The models in the two approaches are unable to reproduce the criteria that the approaches are based on, such as band gap restriction or polar space group. Of course, the materials that the two initial approaches label as good candidates are challenging to go through due to their extensive lengths, whereas the insightful approach predicts fewer good candidates and we are able to manually verify many of the compounds. However, we note that we found predicted good candidates with band gap lower than $0.5$eV for the insightful approach as well.

Of the $85$ predicted good candidates with band gap lower than $0.5$eV that the models in the insightful approach agreed upon, we find $54$ of them also predicted as good by all models in the augmented Ferrenti approach. Similarly, $35$ of them are also predicted as good by all the models in the Ferrenti approach.
